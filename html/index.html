<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>行政区域切换</title>
	<script type="text/javascript" src="../mapdata/china.json"></script>
	<!-- <script type="text/javascript" src="../mapdata/geometryProvince/51.json"></script>
	<script type="text/javascript" src="../mapdata/geometryCouties/510100.json"></script> -->
	<script type="text/javascript" src="../js/echarts.js"></script>
	<script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="../js/script.js"></script>
	<style type="text/css">
		#button{display: none;}
	</style>
</head>
<body>
	<div id="main" style="width: 800px; height: 600px;"></div>
	<button id="button">上一级</button>
</body>
<!-- 依赖百度echarts.js -->
	<script type="text/javascript">
		//var geoData={};    //地图数据
		//geoData=luzhou;

		var chinaData=china;
		var ele=document.getElementById("main");

		var option={
			backgroundColor:"#ffffff",
			center:'',
			visualMapColor:['#50a3ba', '#eac736', '#d94e5d'],
			seriesData:eachGeoJson(chinaData)
		};
		console.log(echarts);
		var mapEchart=new mapEcharts(ele,echarts);
		mapEchart.DropMapGeo("china",chinaData,option,function(params){
			var sichuanData={};
			//获取对应的地图数据
			$.getJSON('../mapdata/geometryProvince/'+params.data.id+'.json',function(data){
				sichuanData=data;
				option.seriesData=eachGeoJson(sichuanData);
				option.center=option.seriesData.cp;
				mapEchart.DropMapGeo("sichuan",sichuanData,option,function(params){
					var chengduData={};
					console.log('../mapdata/geometryCouties/'+params.data.id+'00.json');
					$.getJSON('../mapdata/geometryCouties/'+params.data.id+'00.json',function(data){
						chengduData=data;
						option.seriesData=eachGeoJson(chengduData);
						option.center=option.seriesData.cp;
						mapEchart.DropMapGeo("chengdu",chengduData,option);
						//var linesData=[[103.88,30.82],[104.05,30.70],[104.10,30.67],[104.43,30.85]];
						var linesData=[
							{"name":"郫县","coordinate":[103.88,30.82]},
							{"name":"金牛","coordinate":[104.05,30.70]},
							{"name":"成华","coordinate":[104.10,30.67]},
							{"name":"金堂","coordinate":[104.43,30.85]}
						];
						var lineOption={         //线的配偶参数
							"color":"#fff",     //颜色,默认白色#ffffff
							"width":2,			//宽,默认宽1
							"type":"solid",		//类型 默认soild
							"opacity":0.6		//透明度 默认值0.6
						};
						var line=mapEchart.setDropLines("line",linesData,lineOption);

						var lineAnimationOption={       //线条动画参数
							period:4,					//动画时长
							delay:0,					//动画的延时,支持数字或回调
							constantSpeed:0,    //动画的速度，设置大于0的数字后period将失效
							symbol:'circle',     //图像的标记，可以是图片途径
							color:'#fff',		 //标记的颜色
							symbolSize:3,         //标记的大小
							trailLength:0.2,      //特效尾迹的长度，取值范围（0-1）数值越大，尾迹越长
							loop:true,           //是否循环播放图画
						};   
						mapEchart.setLineAnimation(line,lineAnimationOption,true);
						var spotData=[
							{"text":"郫县","coordinate":[103.88,30.83]},
							{"text":"金牛","coordinate":[104.05,30.71]},
							{"text":"成华","coordinate":[104.10,30.68]},
							{"text":"金堂","coordinate":[104.43,30.86]}
						];

						var spotOption={		//点的配置参数
							color:,
							borderColor:,
							borderWidth:,
							borderType:,
							opacity:
						};
						mapEchart.setDropSpot("spot",spotData,"");

						mapEchart.linster('click',function(params){
							mapEchart.setLineColor(params);
						});
					});
				});
			})
		});



		// mapEchart.DropMapGeo("china",chinaData,option);
		// mapEchart.linster('click',function(params){
		// 	var sichuanData={};
		// 	//获取对应的地图数据
		// 	$.getJSON('../mapdata/geometryProvince/'+params.data.id+'.json',function(data){
		// 		sichuanData=data;
		// 		option.seriesData=eachGeoJson(sichuanData);
		// 		option.center=option.seriesData.cp;
		// 		mapEchart.DropMapGeo("sichuan",sichuanData,option);
		// 		$.getJSON('../mapdata/geometryCouties/'+params.data.id+'00.json',function(data){
		// 			chengduData=data;
		// 			option.seriesData=eachGeoJson(chengduData);
		// 			option.center=option.seriesData.cp;
		// 			mapEchart.DropMapGeo("chengdu",chengduData,option);
		// 		});
		// 		// mapEchart.DropMapGeo("sichuan",sichuanData,option,function(params){
		// 		// 	var chengduData={};
		// 		// 	console.log('../mapdata/geometryCouties/'+params.data.id+'00.json');
		// 		// 	$.getJSON('../mapdata/geometryCouties/'+params.data.id+'00.json',function(data){
		// 		// 		chengduData=data;
		// 		// 		option.seriesData=eachGeoJson(chengduData);
		// 		// 		option.center=option.seriesData.cp;
		// 		// 		mapEchart.DropMapGeo("chengdu",chengduData,option);
		// 		// 	});
		// 		// });
		// 	})
		// });
		


	//遍历geo数据
	function eachGeoJson(geoJson){
		var data=[];
		for(var i=0;i<geoJson.features.length;++i){
			data.push({
				"id":geoJson.features[i].properties.id,
				"name":geoJson.features[i].properties.name,
				"cp":geoJson.features[i].properties.cp,
				"value":0
			}); 
		}
		return data;
	}

	</script>
</html>